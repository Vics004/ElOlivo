@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{

    Layout = "_Layout_Usuario";
    var tipousuario = Context.Session.GetString("tipoUsuario");
}
<!-- FullCalendar CSS -->

<h3>Agenda de Sesiones Disponibles</h3>

@if (tipousuario != "Administrador")
{
    <div>
        <a asp-action="Ver_SesionesPersonales" class="btn btn-primary">Ver Agenda personal</a>
    </div>
}



<!-- Contenedor del calendario -->
<div id="calendar"></div>

<!-- FullCalendar CSS -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet" />

<!-- FullCalendar JS -->
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/locales/es.global.min.js"></script>

<!-- Script para inicializar el calendario -->
@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var calendarEl = document.getElementById('calendar');

            var calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                locale: 'es',
                timeZone: 'local',
                height: 'auto',
                eventDisplay: 'block', // 🔹 Hace visibles los colores de fondo
                eventColor: '#28a745', // color por defecto si no hay uno en BD

                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
                },

                buttonText: { // 🔹 Traducción manual
                    today: 'Hoy',
                    month: 'Mes',
                    week: 'Semana',
                    day: 'Día',
                    list: 'Lista'
                },

                events: '/Usuario/GetEventosPersonal',

                eventClick: function (info) {
                    info.jsEvent.preventDefault();

                    // Obtener el ID del evento (asumiendo que está en info.event.id)
                    var eventoId = info.event.id;

                    // Redirigir a la acción Ver_Mas con el ID
                    if (eventoId) {
                        window.location.href = '/Usuario/Ver_Mas/' + eventoId;
                    } else {
                        console.error('El evento no tiene ID');
                    }
                }
            });

            calendar.render();
        });
    </script>
}


<style>
    #calendar {
        max-width: 100%;
        margin: 20px auto;
        background: #fff;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

</style>